<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Recrutement Staff</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #36393f;
      color: #dcddde;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      background: #2f3136;
      border-radius: 8px;
      padding: 32px;
      width: 100%;
      max-width: 480px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.24);
    }
    .header {
      text-align: center;
      margin-bottom: 32px;
    }
    .header h1 {
      color: #ffffff;
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .header p {
      color: #b9bbbe;
      font-size: 16px;
    }
    .discord-login {
      background: #5865f2;
      color: #ffffff;
      border: none;
      border-radius: 3px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: background-color 0.17s ease;
      margin-bottom: 20px;
    }
    .discord-login:hover {
      background: #4752c4;
    }
    .login-form {
      display: none;
    }
    .login-form.show {
      display: block;
    }
    .user-card {
      background: #202225;
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 20px;
      display: none;
      border: 1px solid #5865f2;
    }
    .user-card.show {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #5865f2;
    }
    .user-info h3 {
      color: #ffffff;
      font-size: 16px;
      font-weight: 600;
    }
    .user-info p {
      color: #b9bbbe;
      font-size: 14px;
    }
    .change-btn {
      background: transparent;
      border: 1px solid #4f545c;
      color: #dcddde;
      border-radius: 3px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      margin-left: auto;
    }
    .change-btn:hover {
      border-color: #dcddde;
    }
    .form-group {
      margin-bottom: 20px;
    }
    .form-label {
      color: #b9bbbe;
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 8px;
      display: block;
    }
    .form-input, .form-select, .form-textarea {
      background: #40444b;
      border: 1px solid #202225;
      border-radius: 3px;
      color: #dcddde;
      font-size: 16px;
      padding: 10px;
      width: 100%;
      transition: border-color 0.15s ease;
    }
    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: #5865f2;
    }
    .form-input::placeholder {
      color: #72767d;
    }
    .form-textarea {
      resize: vertical;
      min-height: 80px;
    }
    .submit-btn {
      background: #3ba55d;
      color: #ffffff;
      border: none;
      border-radius: 3px;
      padding: 12px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.17s ease;
    }
    .submit-btn:hover {
      background: #2d7d43;
    }
    .submit-btn:disabled {
      background: #4f545c;
      cursor: not-allowed;
    }
    .verify-btn {
      background: #5865f2;
      color: #ffffff;
      border: none;
      border-radius: 3px;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      width: 100%;
      transition: background-color 0.17s ease;
    }
    .verify-btn:hover {
      background: #4752c4;
    }
    .application-form {
      display: none;
    }
    .application-form.show {
      display: block;
    }
    .error {
      background: #f04747;
      color: #ffffff;
      padding: 8px 12px;
      border-radius: 3px;
      font-size: 14px;
      margin-bottom: 16px;
      display: none;
    }
    .error.show {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>Rejoignez notre équipe</h1>
      <p>Candidature pour le staff</p>
    </div>

    <div id="loginStep">
      <button class="discord-login" id="loginBtn">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
          <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9460 2.4189-2.1568 2.4189z"/>
        </svg>
        Se connecter avec Discord
      </button>

      <div class="login-form" id="loginForm">
        <div class="error" id="errorMsg"></div>
        
        <div class="form-group">
          <label class="form-label">Nom d'utilisateur</label>
          <input type="text" class="form-input" id="username" placeholder="votrenom">
        </div>
        
        <div class="form-group">
          <label class="form-label">ID utilisateur</label>
          <input type="text" class="form-input" id="userId" placeholder="123456789012345678">
        </div>
        
        <button class="verify-btn" id="verifyBtn">Vérifier</button>
      </div>
    </div>

    <div class="user-card" id="userCard">
      <img class="user-avatar" id="userAvatar" src="">
      <div class="user-info">
        <h3 id="displayName"></h3>
        <p id="userTag"></p>
      </div>
      <button class="change-btn" id="changeBtn">Modifier</button>
    </div>

    <div class="application-form" id="applicationForm">
      <div class="form-group">
        <label class="form-label">Poste souhaité</label>
        <select class="form-select" id="poste">
          <option value="">Sélectionner un poste</option>
          <option value="Helper">Helper</option>
          <option value="Informateur">Informateur</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Motivation</label>
        <textarea class="form-textarea" id="motivation" placeholder="Pourquoi souhaitez-vous rejoindre notre équipe ?"></textarea>
      </div>

      <div class="form-group">
        <label class="form-label">Expérience</label>
        <textarea class="form-textarea" id="experience" placeholder="Décrivez votre expérience (optionnel)"></textarea>
      </div>

      <div class="form-group">
        <label class="form-label">Disponibilités</label>
        <input type="text" class="form-input" id="dispo" placeholder="Vos horaires de disponibilité">
      </div>

      <button class="submit-btn" id="submitBtn">Envoyer la candidature</button>
    </div>
  </div>

  <script>
    const webhookURL = "https://discord.com/api/webhooks/1394609064524386418/sbuTUf8cwk1PkpTbjcDmjbSRXRk2E01jzLo5vHDer--Nk_b_OnKmc5wjL8wTqISAxCRK";
    
    let currentUser = null;

    const loginBtn = document.getElementById('loginBtn');
    const loginForm = document.getElementById('loginForm');
    const userCard = document.getElementById('userCard');
    const applicationForm = document.getElementById('applicationForm');
    const errorMsg = document.getElementById('errorMsg');
    const verifyBtn = document.getElementById('verifyBtn');
    const changeBtn = document.getElementById('changeBtn');
    const submitBtn = document.getElementById('submitBtn');

    loginBtn.addEventListener('click', () => {
      loginForm.classList.add('show');
      loginBtn.style.display = 'none';
    });

    verifyBtn.addEventListener('click', verifyUser);
    changeBtn.addEventListener('click', resetForm);
    submitBtn.addEventListener('click', submitApplication);

    async function verifyUser() {
      const username = document.getElementById('username').value.trim();
      const userId = document.getElementById('userId').value.trim();
      
      if (!username || !userId) {
        showError('Veuillez remplir tous les champs');
        return;
      }
      
      if (!/^\d{17,19}$/.test(userId)) {
        showError('ID utilisateur invalide');
        return;
      }

      try {
        const response = await fetch(`https://discord.com/api/v10/users/${userId}`, {
          headers: {
            'Authorization': 'Bot MTMwNjk4MjgxMzU4NzI2NTYzNg.GqQx-E.example'
          }
        });

        if (response.ok) {
          const userData = await response.json();
          if (userData.username.toLowerCase() === username.toLowerCase()) {
            currentUser = userData;
            showUserCard();
            showApplicationForm();
            hideError();
          } else {
            showError('Le nom d\'utilisateur ne correspond pas');
          }
        } else {
          showError('Utilisateur non trouvé');
        }
      } catch (error) {
        const userData = {
          id: userId,
          username: username,
          avatar: null,
          discriminator: '0'
        };
        currentUser = userData;
        showUserCard();
        showApplicationForm();
        hideError();
      }
    }

    function showUserCard() {
      const avatarUrl = currentUser.avatar 
        ? `https://cdn.discordapp.com/avatars/${currentUser.id}/${currentUser.avatar}.png`
        : `https://cdn.discordapp.com/embed/avatars/${Math.floor(Math.random() * 5)}.png`;
      
      document.getElementById('userAvatar').src = avatarUrl;
      document.getElementById('displayName').textContent = currentUser.global_name || currentUser.username;
      document.getElementById('userTag').textContent = `@${currentUser.username}`;
      
      userCard.classList.add('show');
      loginForm.classList.remove('show');
    }

    function showApplicationForm() {
      applicationForm.classList.add('show');
    }

    function resetForm() {
      currentUser = null;
      userCard.classList.remove('show');
      applicationForm.classList.remove('show');
      loginForm.classList.remove('show');
      loginBtn.style.display = 'flex';
      document.getElementById('username').value = '';
      document.getElementById('userId').value = '';
      hideError();
    }

    async function submitApplication() {
      if (!currentUser) return;
      
      const poste = document.getElementById('poste').value;
      const motivation = document.getElementById('motivation').value;
      const experience = document.getElementById('experience').value;
      const dispo = document.getElementById('dispo').value;
      
      if (!poste || !motivation || !dispo) {
        showError('Veuillez remplir tous les champs obligatoires');
        return;
      }

      const avatarUrl = currentUser.avatar 
        ? `https://cdn.discordapp.com/avatars/${currentUser.id}/${currentUser.avatar}.png`
        : `https://cdn.discordapp.com/embed/avatars/0.png`;

      const payload = {
        embeds: [{
          title: "📋 Nouvelle Candidature",
          color: 5865522,
          fields: [
            { name: "👤 Utilisateur", value: `<@${currentUser.id}>`, inline: true },
            { name: "🏷️ Tag", value: `@${currentUser.username}`, inline: true },
            { name: "🆔 ID", value: currentUser.id, inline: true },
            { name: "💼 Poste", value: poste, inline: false },
            { name: "💭 Motivation", value: motivation, inline: false },
            { name: "📚 Expérience", value: experience || "Aucune expérience mentionnée", inline: false },
            { name: "⏰ Disponibilités", value: dispo, inline: false }
          ],
          thumbnail: { url: avatarUrl },
          timestamp: new Date().toISOString(),
          footer: { text: "Système de recrutement" }
        }]
      };

      try {
        const response = await fetch(webhookURL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        if (response.ok) {
          alert('✅ Candidature envoyée avec succès !');
          resetForm();
        } else {
          showError('Erreur lors de l\'envoi');
        }
      } catch (error) {
        showError('Erreur de connexion');
      }
    }

    function showError(message) {
      errorMsg.textContent = message;
      errorMsg.classList.add('show');
    }

    function hideError() {
      errorMsg.classList.remove('show');
    }
  </script>
</body>
</html>
